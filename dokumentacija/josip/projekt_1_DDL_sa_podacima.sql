-- SKRIPTA ZA PROJEKT: SUSTAV GRADSKOG PRIJEVOZA
SET FOREIGN_KEY_CHECKS = 0;
DROP DATABASE IF EXISTS gradski_prijevoz;
CREATE DATABASE gradski_prijevoz CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE gradski_prijevoz;
SET FOREIGN_KEY_CHECKS = 1;

-- 1. TABLICA: ZONE
CREATE TABLE zone (
    id INT AUTO_INCREMENT PRIMARY KEY,
    zona_kod VARCHAR(10) NOT NULL UNIQUE,
    zona_naziv VARCHAR(100) NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO zone (zona_kod, zona_naziv) VALUES 
('Z1', 'Centar - Grad'),
('Z2', 'Šira gradska zona'),
('Z3', 'Prigradsko naselje Sjever'),
('Z4', 'Prigradsko naselje Jug'),
('Z5', 'Zračna luka i okolica'),
('Z6', 'Industrijska zona'),
('Z7', 'Turistička zona Sljeme'),
('Z8', 'Samobor i okolica'),
('Z9', 'Velika Gorica'),
('Z10', 'Zaprešić'),
('Z11', 'Sesvete'),
('Z12', 'Novi Zagreb - Istok'),
('Z13', 'Novi Zagreb - Zapad'),
('Z14', 'Jarun/Prečko'),
('Z15', 'Dubrava/Sesvete'),
('Z16', 'Gornji Grad'),
('Z17', 'Maksimir'),
('Z18', 'Trešnjevka Jug'),
('Z19', 'Trešnjevka Sjever'),
('Z20', 'Peščenica'),
('Z21', 'Trnje'),
('Z22', 'Črnomerec'),
('Z23', 'Stenjevec'),
('Z24', 'Podsused'),
('Z25', 'Donji Grad'),
('Z26', 'Gornja Dubrava'),
('Z27', 'Donja Dubrava'),
('Z28', 'Podsljeme'),
('Z29', 'Brezovica'),
('Z30', 'Žitnjak');

-- 2. TABLICA: VOZILA
CREATE TABLE vozila (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tip_vozila ENUM('Autobus', 'Tramvaj', 'Minibus', 'Kombi') NOT NULL,
    registarska_oznaka VARCHAR(10) NOT NULL UNIQUE,
    u_prometu BOOLEAN NOT NULL DEFAULT TRUE,
    vrsta_goriva VARCHAR(20) NOT NULL,
    kapacitet_putnika INT NOT NULL,
    CONSTRAINT chk_kapacitet CHECK (kapacitet_putnika > 0)
);

INSERT INTO vozila (tip_vozila, registarska_oznaka, u_prometu, vrsta_goriva, kapacitet_putnika) VALUES
('Tramvaj', 'ZG-001-TR', 1, 'Električna', 150),
('Tramvaj', 'ZG-002-TR', 1, 'Električna', 150),
('Tramvaj', 'ZG-003-TR', 1, 'Električna', 150),
('Autobus', 'ZG-101-AU', 1, 'Dizel', 80),
('Autobus', 'ZG-102-AU', 1, 'Biodizel', 80),
('Autobus', 'ZG-103-AU', 1, 'Plin', 80),
('Minibus', 'ZG-201-MI', 1, 'Dizel', 25),
('Kombi', 'ZG-301-KO', 1, 'Plin', 12),
('Autobus', 'ZG-104-AU', 1, 'Dizel', 85),
('Autobus', 'ZG-105-AU', 1, 'Dizel', 80),
('Tramvaj', 'ZG-004-TR', 1, 'Električna', 160),
('Tramvaj', 'ZG-005-TR', 1, 'Električna', 150),
('Autobus', 'ZG-106-AU', 1, 'Hibrid', 75),
('Autobus', 'ZG-107-AU', 1, 'Dizel', 80),
('Autobus', 'ZG-108-AU', 1, 'Plin', 80),
('Minibus', 'ZG-202-MI', 1, 'Dizel', 25),
('Kombi', 'ZG-302-KO', 1, 'Dizel', 10),
('Autobus', 'ZG-109-AU', 1, 'Dizel', 80),
('Autobus', 'ZG-110-AU', 1, 'Biodizel', 80),
('Autobus', 'ZG-111-AU', 1, 'Dizel', 90),
('Tramvaj', 'ZG-006-TR', 1, 'Električna', 150),
('Tramvaj', 'ZG-007-TR', 1, 'Električna', 150),
('Autobus', 'ZG-112-AU', 1, 'Plin', 80),
('Autobus', 'ZG-113-AU', 1, 'Dizel', 80),
('Autobus', 'ZG-114-AU', 1, 'Dizel', 80),
('Minibus', 'ZG-203-MI', 1, 'Dizel', 30),
('Autobus', 'ZG-115-AU', 0, 'Dizel', 80),
('Autobus', 'ZG-116-AU', 1, 'Dizel', 80),
('Autobus', 'ZG-117-AU', 1, 'Plin', 80),
('Autobus', 'ZG-118-AU', 1, 'Dizel', 80);

-- 3. TABLICA: LINIJE
CREATE TABLE linije (
    id INT AUTO_INCREMENT PRIMARY KEY,
    oznaka VARCHAR(10) NOT NULL UNIQUE,
    naziv VARCHAR(100) NOT NULL,
    tip_linije ENUM('Tramvajska', 'Autobusna', 'Uspinjača', 'Žičara') NOT NULL,
    duljina_km DECIMAL(5,2) NOT NULL,
    CONSTRAINT chk_duljina CHECK (duljina_km > 0)
);

INSERT INTO linije (oznaka, naziv, tip_linije, duljina_km) VALUES
('1', 'Črnomerec - Borongaj', 'Tramvajska', 8.5),
('2', 'Črnomerec - Savišće', 'Tramvajska', 10.2),
('3', 'Ljubljanica - Savišće', 'Tramvajska', 9.5),
('4', 'Savski most - Dubec', 'Tramvajska', 14.2),
('5', 'Prečko - Maksimir', 'Tramvajska', 11.0),
('6', 'Črnomerec - Sopot', 'Tramvajska', 9.8),
('7', 'Savski most - Dubrava', 'Tramvajska', 12.5),
('8', 'Mihaljevac - Zapruđe', 'Tramvajska', 10.0),
('9', 'Ljubljanica - Borongaj', 'Tramvajska', 8.9),
('11', 'Črnomerec - Dubec', 'Tramvajska', 13.1),
('12', 'Ljubljanica - Dubrava', 'Tramvajska', 11.8),
('13', 'Žitnjak - Kvaternikov trg', 'Tramvajska', 7.5),
('14', 'Mihaljevac - Zapruđe', 'Tramvajska', 11.2),
('17', 'Prečko - Borongaj', 'Tramvajska', 14.0),
('101', 'Britanski trg - Prekrižje', 'Autobusna', 5.2),
('102', 'Britanski trg - Mihaljevac', 'Autobusna', 6.5),
('103', 'Britanski trg - Kraljevec', 'Autobusna', 4.1),
('105', 'Kaptol - Britanski trg', 'Autobusna', 3.8),
('107', 'Jankomir - Žitnjak', 'Autobusna', 15.5),
('109', 'Črnomerec - Dugave', 'Autobusna', 12.8),
('118', 'Trg Mažuranića - Voltino', 'Autobusna', 4.5),
('172', 'Črnomerec - Zaprešić', 'Autobusna', 17.0),
('212', 'Dubec - Sesvete', 'Autobusna', 6.2),
('220', 'Glavni kolodvor - Dugave', 'Autobusna', 9.1),
('221', 'Glavni kolodvor - Travno', 'Autobusna', 8.8),
('234', 'Glavni kolodvor - Lanište', 'Autobusna', 7.9),
('268', 'Glavni kolodvor - Velika Gorica', 'Autobusna', 19.5),
('281', 'Glavni kolodvor - Novi Jelkovec', 'Autobusna', 14.2),
('301', 'Uspinjača Donji Grad', 'Uspinjača', 0.1),
('401', 'Žičara Sljeme', 'Žičara', 5.0);

-- 4. TABLICA: STANICE
CREATE TABLE stanice (
    id INT AUTO_INCREMENT PRIMARY KEY,
    naziv VARCHAR(100) NOT NULL,
    zona_id INT NOT NULL,
    FOREIGN KEY (zona_id) REFERENCES zone(id)
);

INSERT INTO stanice (naziv, zona_id) VALUES 
('Trg bana Jelačića', 1),
('Glavni kolodvor', 1),
('Črnomerec', 22),
('Borongaj', 4),
('Ljubljanica', 19),
('Dubec', 11),
('Savišće', 30),
('Savski most', 13),
('Prečko', 14),
('Maksimir', 17),
('Sopot', 12),
('Mihaljevac', 28),
('Zapruđe', 12),
('Žitnjak', 30),
('Kvaternikov trg', 25),
('Britanski trg', 25),
('Prekrižje', 28),
('Kraljevec', 28),
('Kaptol', 1),
('Jankomir', 24),
('Dugave', 13),
('Trg Mažuranića', 25),
('Voltino', 18),
('Zaprešić Centar', 10),
('Sesvete Centar', 11),
('Travno', 12),
('Lanište', 13),
('Velika Gorica Kolodvor', 9),
('Novi Jelkovec', 11),
('Sljeme Vrh', 7);

-- 5. TABLICA: LINIJE_STANICE (Povezivanje linija i stanica)
CREATE TABLE linije_stanice (
    linija_id INT NOT NULL,
    stanica_id INT NOT NULL,
    redoslijed INT NOT NULL,
    PRIMARY KEY (linija_id, stanica_id),
    FOREIGN KEY (linija_id) REFERENCES linije(id),
    FOREIGN KEY (stanica_id) REFERENCES stanice(id)
);

INSERT INTO linije_stanice (linija_id, stanica_id, redoslijed) VALUES
(1, 3, 1),
(1, 1, 10),
(1, 4, 20),
(2, 3, 1),
(2, 1, 10),
(2, 7, 20),
(4, 8, 1),
(4, 1, 15),
(4, 6, 30),
(6, 3, 1),
(6, 1, 10),
(6, 11, 20),
(10, 3, 1),
(10, 6, 25),
(20, 3, 1),
(20, 21, 15),
(27, 2, 1),
(27, 28, 20),
(29, 1, 1),
(29, 16, 5),
(30, 14, 1),
(30, 30, 10),
(15, 16, 1),
(15, 17, 10),
(21, 22, 1),
(21, 23, 10),
(16, 16, 1),
(16, 12, 10),
(11, 5, 1),
(11, 19, 15),
(12, 14, 1),
(12, 15, 10);

-- 6. TABLICA: ZAPOSLENICI
CREATE TABLE zaposlenik (
    id INT AUTO_INCREMENT PRIMARY KEY,
    zaposlenik_broj VARCHAR(20) NOT NULL UNIQUE,
    ime VARCHAR(50) NOT NULL,
    prezime VARCHAR(50) NOT NULL,
    oib CHAR(11) NOT NULL UNIQUE,
    email VARCHAR(100) UNIQUE,
    naziv_uloge VARCHAR(100) NOT NULL,
    datum_zaposlenja DATE NOT NULL,
    CONSTRAINT chk_oib_len CHECK (LENGTH(oib) = 11)
);

INSERT INTO zaposlenik (zaposlenik_broj, ime, prezime, oib, email, naziv_uloge, datum_zaposlenja) VALUES
('Z-001', 'Ivan', 'Ivić', '12345678901', 'ivan.ivic@grad.hr', 'Vozač', '2010-05-01'),
('Z-002', 'Marko', 'Marić', '12345678902', 'marko.maric@grad.hr', 'Vozač', '2012-03-15'),
('Z-003', 'Ana', 'Anić', '12345678903', 'ana.anic@grad.hr', 'Dispečer', '2015-06-20'),
('Z-004', 'Pero', 'Perić', '12345678904', 'pero.peric@grad.hr', 'Vozač', '2014-08-10'),
('Z-005', 'Iva', 'Ivić', '12345678905', 'iva.ivic@grad.hr', 'Kontrolor', '2018-01-05'),
('Z-006', 'Stipe', 'Stipić', '12345678906', 'stipe.stipic@grad.hr', 'Vozač', '2011-11-11'),
('Z-007', 'Maja', 'Majić', '12345678907', 'maja.majic@grad.hr', 'Vozač', '2013-02-22'),
('Z-008', 'Luka', 'Lukić', '12345678908', 'luka.lukic@grad.hr', 'Mehaničar', '2016-09-30'),
('Z-009', 'Sara', 'Sarić', '12345678909', 'sara.saric@grad.hr', 'Vozač', '2015-04-12'),
('Z-010', 'Davor', 'Davorić', '12345678910', 'davor.davoric@grad.hr', 'Vozač', '2010-12-01'),
('Z-011', 'Tanja', 'Tanjić', '12345678911', 'tanja.tanjic@grad.hr', 'Referent', '2019-07-07'),
('Z-012', 'Goran', 'Goranović', '12345678912', 'goran.goranovic@grad.hr', 'Vozač', '2012-05-05'),
('Z-013', 'Borna', 'Bornić', '12345678913', 'borna.bornic@grad.hr', 'Vozač', '2017-03-03'),
('Z-014', 'Lea', 'Leić', '12345678914', 'lea.leic@grad.hr', 'Vozač', '2016-10-10'),
('Z-015', 'Mate', 'Matić', '12345678915', 'mate.matic@grad.hr', 'Čuvar', '2020-02-01'),
('Z-016', 'Nika', 'Nikić', '12345678916', 'nika.nikic@grad.hr', 'Vozač', '2014-06-06'),
('Z-017', 'Bruno', 'Brunić', '12345678917', 'bruno.brunic@grad.hr', 'Vozač', '2013-09-09'),
('Z-018', 'Klara', 'Klarić', '12345678918', 'klara.klaric@grad.hr', 'Vozač', '2018-12-12'),
('Z-019', 'Roko', 'Rokić', '12345678919', 'roko.rokic@grad.hr', 'Inženjer', '2011-01-15'),
('Z-020', 'Lana', 'Lanić', '12345678920', 'lana.lanic@grad.hr', 'Vozač', '2015-10-25'),
('Z-021', 'Vito', 'Vitić', '12345678921', 'vito.vitic@grad.hr', 'Vozač', '2016-04-14'),
('Z-022', 'Zora', 'Zorić', '12345678922', 'zora.zoric@grad.hr', 'Vozač', '2012-08-08'),
('Z-023', 'Ines', 'Inesić', '12345678923', 'ines.inesic@grad.hr', 'Vozač', '2017-11-20'),
('Z-024', 'Sven', 'Svenić', '12345678924', 'sven.svenic@grad.hr', 'Mehaničar', '2014-03-18'),
('Z-025', 'Pavle', 'Pavlić', '12345678925', 'pavle.pavlic@grad.hr', 'Vozač', '2019-05-05'),
('Z-026', 'Marta', 'Martić', '12345678926', 'marta.martic@grad.hr', 'Vozač', '2011-02-28'),
('Z-027', 'Denis', 'Denisić', '12345678927', 'denis.denisic@grad.hr', 'Vozač', '2013-07-12'),
('Z-028', 'Helena', 'Helenić', '12345678928', 'helena.helenic@grad.hr', 'Vozač', '2016-01-01'),
('Z-029', 'Filip', 'Filipović', '12345678929', 'filip.f@grad.hr', 'IT podrška', '2021-06-15'),
('Z-030', 'Oleg', 'Olegić', '12345678930', 'oleg.olegic@grad.hr', 'Vozač', '2018-04-30');

-- 7. TABLICA: KALENDARI
CREATE TABLE kalendari (
    id INT AUTO_INCREMENT PRIMARY KEY,
    kalendar_naziv VARCHAR(50) NOT NULL,
    ponedjeljak BOOLEAN DEFAULT TRUE,
    utorak BOOLEAN DEFAULT TRUE,
    srijeda BOOLEAN DEFAULT TRUE,
    cetvrtak BOOLEAN DEFAULT TRUE,
    petak BOOLEAN DEFAULT TRUE,
    subota BOOLEAN DEFAULT FALSE,
    nedjelja BOOLEAN DEFAULT FALSE
);

INSERT INTO kalendari (kalendar_naziv, ponedjeljak, utorak, srijeda, cetvrtak, petak, subota, nedjelja) VALUES
('Radni tjedan', 1, 1, 1, 1, 1, 0, 0),
('Cijeli tjedan', 1, 1, 1, 1, 1, 1, 1),
('Samo vikend', 0, 0, 0, 0, 0, 1, 1),
('Samo nedjelja', 0, 0, 0, 0, 0, 0, 1),
('Praznik', 0, 0, 0, 0, 0, 0, 1),
('Školska godina', 1, 1, 1, 1, 1, 0, 0),
('Ljetni red', 1, 1, 1, 1, 1, 1, 1),
('Zimski red', 1, 1, 1, 1, 1, 1, 1),
('Noćna smjena Pon-Pet', 1, 1, 1, 1, 1, 0, 0),
('Noćna smjena Vikend', 0, 0, 0, 0, 0, 1, 1),
('Smjena A (Par)', 1, 0, 1, 0, 1, 0, 0),
('Smjena B (Nepar)', 0, 1, 0, 1, 0, 1, 0),
('Turistička sezona', 1, 1, 1, 1, 1, 1, 1),
('Prigradska linija', 1, 1, 1, 1, 1, 0, 0),
('Dostavna linija', 1, 0, 1, 0, 1, 0, 0),
('Sajam Subotom', 0, 0, 0, 0, 0, 1, 0),
('Studentski red', 1, 1, 1, 1, 1, 0, 0),
('Izvanredna linija', 0, 0, 0, 0, 0, 0, 0),
('Tjedan 1', 1, 1, 0, 0, 0, 0, 0),
('Tjedan 2', 0, 0, 1, 1, 0, 0, 0),
('Tjedan 3', 0, 0, 0, 0, 1, 1, 1),
('Specijalna 1', 1, 0, 0, 1, 0, 0, 1),
('Specijalna 2', 0, 1, 0, 0, 1, 0, 0),
('Specijalna 3', 0, 0, 1, 0, 0, 1, 0),
('Smjena 2-2-3', 1, 1, 0, 0, 1, 1, 1),
('Smjena 5-2', 1, 1, 1, 1, 1, 0, 0),
('Smjena 4-3', 1, 1, 1, 1, 0, 0, 0),
('Jutarnja 1', 1, 1, 1, 0, 0, 0, 0),
('Popodnevna 1', 0, 0, 0, 1, 1, 1, 1),
('Međusmjena', 1, 1, 1, 1, 1, 1, 1);

-- 8. TABLICA: VOZNI RED
CREATE TABLE vozni_red (
    id INT AUTO_INCREMENT PRIMARY KEY,
    linija_id INT NOT NULL,
    vozilo_id INT NOT NULL,
    vozac_id INT NOT NULL,
    kalendar_id INT NOT NULL,
    vrijeme_polaska TIME NOT NULL,
    FOREIGN KEY (linija_id) REFERENCES linije(id),
    FOREIGN KEY (vozilo_id) REFERENCES vozila(id),
    FOREIGN KEY (vozac_id) REFERENCES zaposlenik(id),
    FOREIGN KEY (kalendar_id) REFERENCES kalendari(id)
);

INSERT INTO vozni_red (linija_id, vozilo_id, vozac_id, kalendar_id, vrijeme_polaska) VALUES
(1, 1, 1, 1, '05:00:00'),
(1, 2, 2, 1, '05:20:00'),
(2, 3, 4, 1, '05:10:00'),
(3, 11, 6, 2, '06:00:00'),
(4, 12, 7, 1, '05:30:00'),
(6, 21, 9, 1, '05:45:00'),
(7, 22, 10, 1, '06:15:00'),
(20, 4, 12, 1, '07:00:00'),
(27, 5, 13, 2, '06:30:00'),
(22, 6, 14, 1, '05:00:00'),
(23, 10, 16, 1, '08:00:00'),
(24, 13, 17, 1, '07:15:00'),
(25, 14, 18, 1, '06:45:00'),
(26, 15, 20, 1, '09:00:00'),
(27, 23, 21, 2, '10:00:00'),
(28, 24, 22, 2, '11:00:00'),
(1, 1, 23, 1, '13:00:00'),
(1, 2, 25, 1, '13:20:00'),
(2, 3, 26, 1, '13:10:00'),
(15, 4, 27, 1, '08:00:00'),
(16, 5, 28, 1, '09:00:00'),
(17, 6, 30, 1, '10:00:00'),
(18, 10, 1, 1, '11:00:00'),
(19, 13, 2, 1, '12:00:00'),
(20, 14, 4, 1, '14:00:00'),
(21, 15, 6, 1, '15:00:00'),
(10, 21, 7, 1, '16:00:00'),
(11, 22, 9, 1, '17:00:00'),
(12, 23, 10, 1, '18:00:00'),
(13, 24, 12, 1, '19:00:00');

-- 9. TABLICA: KATEGORIJA PUTNIK
CREATE TABLE kategorija_putnik (
    id INT AUTO_INCREMENT PRIMARY KEY,
    kategorija_naziv VARCHAR(50) NOT NULL,
    kategorija_kod VARCHAR(10) NOT NULL UNIQUE,
    min_dob INT DEFAULT 0,
    max_dob INT DEFAULT 120,
    postotak_popusta DECIMAL(5,2) DEFAULT 0,
    CONSTRAINT chk_age CHECK (max_dob >= min_dob),
    CONSTRAINT chk_discount CHECK (postotak_popusta BETWEEN 0 AND 100)
);

INSERT INTO kategorija_putnik (kategorija_naziv, kategorija_kod, min_dob, max_dob, postotak_popusta) VALUES
('Redovni student', 'STUD', 18, 26, 50.00),
('Umirovljenik', 'PENZ', 65, 120, 70.00),
('Zaposlenik', 'RADN', 18, 65, 0.00),
('Dijete do 7 god', 'DJE7', 0, 7, 100.00),
('Učenik', 'UCEN', 7, 19, 40.00),
('Invalid 1. kat', 'INV1', 0, 120, 100.00),
('Branitelj', 'BRAN', 40, 120, 20.00),
('Počasni građanin', 'POCA', 0, 120, 100.00),
('Turist 1-dan', 'TUR1', 0, 120, 0.00),
('Turist 3-dana', 'TUR3', 0, 120, 10.00),
('Socijalna karta', 'SOCI', 18, 120, 90.00),
('Član obitelji zap.', 'FAMI', 0, 120, 50.00),
('Slobodni umjetnik', 'UMJE', 18, 65, 15.00),
('Darivatelj krvi', 'DDKV', 18, 120, 25.00),
('Godišnja opća', 'GODI', 0, 120, 5.00),
('Mladi do 25 god', 'MLA25', 19, 25, 10.00),
('Sezonski radnik', 'SEZO', 18, 65, 5.00),
('Vatrogasac DVD', 'FIRE', 18, 65, 100.00),
('GSS Volonter', 'GSSV', 18, 65, 100.00),
('Sportaš', 'SPOR', 7, 30, 15.00),
('Novinar', 'PRES', 18, 65, 10.00),
('Strani student', 'ERAS', 18, 30, 40.00),
('Doktorand', 'PHDS', 25, 35, 30.00),
('Diplomat', 'DIPL', 0, 120, 0.00),
('Radnik u noćnoj', 'NIGHT', 18, 65, 10.00),
('Velika obitelj', 'BIGF', 0, 120, 35.00),
('Samohrani roditelj', 'SAMP', 18, 65, 45.00),
('Osnovnoškolac', 'OSNO', 7, 15, 60.00),
('Srednjoškolac', 'SRED', 15, 19, 50.00),
('Umirovljenik-Ino', 'PENI', 65, 120, 30.00);

-- 10. TABLICA: KORISNICI
CREATE TABLE korisnici (
    id INT AUTO_INCREMENT PRIMARY KEY,
    kategorija_id INT NOT NULL,
    ime VARCHAR(50) NOT NULL,
    prezime VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE,
    datum_rodenja DATE,
    status_racuna ENUM('Aktivan', 'Neaktivan', 'Suspendiran') DEFAULT 'Aktivan',
    FOREIGN KEY (kategorija_id) REFERENCES kategorija_putnik(id)
);

INSERT INTO korisnici (kategorija_id, ime, prezime, email, datum_rodenja, status_racuna) VALUES
(1, 'Luka', 'Lukić', 'luka.l@mail.com', '2001-05-10', 'Aktivan'),
(2, 'Baka', 'Mraz', 'baka.m@mail.com', '1950-12-25', 'Aktivan'),
(3, 'Stipe', 'Stipić', 'stipe.s@mail.com', '1985-03-12', 'Aktivan'),
(4, 'Mali', 'Ivica', 'ivica.m@mail.com', '2018-06-01', 'Aktivan'),
(5, 'Tea', 'Teić', 'tea.t@mail.com', '2008-09-14', 'Aktivan'),
(6, 'Josip', 'Josić', 'josip.j@mail.com', '1975-11-20', 'Aktivan'),
(7, 'Ante', 'Antić', 'ante.a@mail.com', '1960-01-05', 'Aktivan'),
(1, 'Maja', 'Majić', 'maja.m@mail.com', '2002-04-18', 'Aktivan'),
(3, 'Davor', 'Davorić', 'davor.d@mail.com', '1990-07-22', 'Aktivan'),
(2, 'Mara', 'Marić', 'mara.m@mail.com', '1945-08-30', 'Aktivan'),
(11, 'Pero', 'Perić', 'pero.p@mail.com', '1970-10-10', 'Aktivan'),
(1, 'Nika', 'Nikić', 'nika.n@mail.com', '2000-12-12', 'Aktivan'),
(5, 'Sven', 'Svenić', 'sven.s@mail.com', '2010-02-02', 'Aktivan'),
(10, 'John', 'Doe', 'john.d@mail.com', '1995-05-05', 'Aktivan'),
(14, 'Filip', 'Filipić', 'filip.f@mail.com', '1988-08-08', 'Aktivan'),
(18, 'Vatroslav', 'Vatrić', 'vatro.v@mail.com', '1992-01-01', 'Aktivan'),
(20, 'Lana', 'Lanić', 'lana.l@mail.com', '2005-03-03', 'Aktivan'),
(1, 'Borna', 'Bornić', 'borna.b@mail.com', '2001-07-07', 'Aktivan'),
(3, 'Goran', 'Goranović', 'goran.g@mail.com', '1982-11-11', 'Aktivan'),
(2, 'Štef', 'Štefić', 'stef.s@mail.com', '1952-09-09', 'Aktivan'),
(4, 'Ema', 'Emić', 'ema.e@mail.com', '2019-04-04', 'Aktivan'),
(5, 'Roko', 'Rokić', 'roko.r@mail.com', '2007-01-15', 'Aktivan'),
(3, 'Tanja', 'Tanjić', 'tanja.ta@mail.com', '1987-10-25', 'Aktivan'),
(25, 'Noćni', 'Radnik', 'noc@mail.com', '1993-02-28', 'Aktivan'),
(27, 'Samka', 'Samić', 'samka@mail.com', '1984-06-06', 'Aktivan'),
(1, 'Ivan', 'Zec', 'ivan.z@mail.com', '2003-08-08', 'Aktivan'),
(2, 'Ivanka', 'Ivanković', 'ivanka@mail.com', '1948-12-12', 'Aktivan'),
(3, 'Kruno', 'Krunić', 'kruno@mail.com', '1978-05-05', 'Aktivan'),
(5, 'Petra', 'Petrić', 'petra.p@mail.com', '2009-03-03', 'Aktivan'),
(1, 'Matija', 'Matić', 'matija.m@mail.com', '2002-11-11', 'Aktivan');

-- 11. TABLICA: TIP KARTE
CREATE TABLE tip_karte (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tip_naziv VARCHAR(100) NOT NULL,
    tip_kod VARCHAR(20) NOT NULL UNIQUE,
    osnovna_cijena DECIMAL(10,2) NOT NULL,
    trajanje_minute INT NOT NULL,
    CONSTRAINT chk_price CHECK (osnovna_cijena >= 0)
);

INSERT INTO tip_karte (tip_naziv, tip_kod, osnovna_cijena, trajanje_minute) VALUES
('Pojedinačna 30min', 'P30', 0.53, 30),
('Pojedinačna 60min', 'P60', 0.93, 60),
('Pojedinačna 90min', 'P90', 1.33, 90),
('Dnevna', 'D1', 3.98, 1440),
('Trodnevna', 'D3', 9.29, 4320),
('Sedmodnevna', 'D7', 19.91, 10080),
('Mjesečna Radnička', 'MR', 47.78, 43200),
('Mjesečna Stud/Učen', 'MSU', 13.27, 43200),
('Mjesečna Umirovljenička', 'MUM', 13.27, 43200),
('Mjesečna Socijalna', 'MSO', 0.00, 43200),
('Godišnja Radnička', 'GR', 462.31, 525600),
('Godišnja Stud/Učen', 'GSU', 120.00, 525600),
('Godišnja Umirovljenička', 'GUM', 120.00, 525600),
('Noćna karta', 'NOC', 1.99, 120),
('Uspinjača karta', 'USP', 0.66, 15),
('Žičara Sljeme 1-smjer', 'Z1', 6.64, 60),
('Žičara Sljeme povratna', 'ZP', 9.95, 180),
('Turistička 24h', 'T24', 10.00, 1440),
('Grupna karta (10 os)', 'G10', 5.00, 120),
('Vikend karta', 'VIK', 2.00, 2880),
('Biciklistička', 'BIC', 1.00, 60),
('Prtljažna', 'PRT', 0.50, 90),
('Doplatna karta', 'DOP', 20.00, 0),
('Multimodalna 2h', 'MUL', 2.50, 120),
('Ekspres linija', 'EKS', 2.00, 60),
('Aerodromska linija', 'AER', 5.00, 90),
('Kratka relacija (2 stan)', 'KRA', 0.40, 15),
('Vlak+Tramvaj 24h', 'VT2', 5.00, 1440),
('Mjesečna izvan zune', 'MIZ', 60.00, 43200),
('Godišnja izvan zone', 'GIZ', 600.00, 525600);

-- 12. TABLICA: KARTE (Prodane)
CREATE TABLE karta (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tip_karte_id INT NOT NULL,
    korisnik_id INT NOT NULL,
    karta_kod VARCHAR(50) NOT NULL UNIQUE,
    datum_kupnje DATETIME DEFAULT CURRENT_TIMESTAMP,
    vrijedi_do DATETIME NOT NULL,
    placena_cijena DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (tip_karte_id) REFERENCES tip_karte(id),
    FOREIGN KEY (korisnik_id) REFERENCES korisnici(id)
);

INSERT INTO karta (tip_karte_id, korisnik_id, karta_kod, datum_kupnje, vrijedi_do, placena_cijena) VALUES
(1, 1, 'K-001', '2023-12-01 08:00:00', '2023-12-01 08:30:00', 0.27),
(2, 3, 'K-002', '2023-12-01 09:00:00', '2023-12-01 10:00:00', 0.93),
(7, 3, 'K-003', '2023-12-01 10:00:00', '2023-12-31 23:59:59', 47.78),
(8, 1, 'K-004', '2023-12-01 10:30:00', '2023-12-31 23:59:59', 6.64),
(15, 2, 'K-005', '2023-12-01 11:00:00', '2023-12-01 11:15:00', 0.20),
(4, 4, 'K-006', '2023-12-01 12:00:00', '2023-12-02 12:00:00', 0.00),
(16, 5, 'K-007', '2023-12-01 13:00:00', '2023-12-01 14:00:00', 4.00),
(3, 6, 'K-008', '2023-12-01 14:00:00', '2023-12-01 15:30:00', 0.00),
(1, 8, 'K-009', '2023-12-02 08:00:00', '2023-12-02 08:30:00', 0.27),
(7, 9, 'K-010', '2023-12-01 07:00:00', '2023-12-31 23:59:59', 47.78),
(2, 10, 'K-011', '2023-12-02 10:00:00', '2023-12-02 11:00:00', 0.28),
(10, 11, 'K-012', '2023-12-01 09:00:00', '2023-12-31 23:59:59', 0.00),
(8, 12, 'K-013', '2023-12-01 08:30:00', '2023-12-31 23:59:59', 6.64),
(1, 13, 'K-014', '2023-12-02 11:00:00', '2023-12-02 11:30:00', 0.32),
(1, 14, 'K-015', '2023-12-02 12:00:00', '2023-12-02 12:30:00', 0.53),
(1, 15, 'K-016', '2023-12-02 13:00:00', '2023-12-02 13:30:00', 0.40),
(14, 16, 'K-017', '2023-12-02 23:00:00', '2023-12-03 01:00:00', 0.00),
(2, 17, 'K-018', '2023-12-03 09:00:00', '2023-12-03 10:00:00', 0.79),
(8, 18, 'K-019', '2023-12-01 10:00:00', '2023-12-31 23:59:59', 6.64),
(7, 19, 'K-020', '2023-12-01 08:00:00', '2023-12-31 23:59:59', 47.78),
(1, 21, 'K-021', '2023-12-03 10:00:00', '2023-12-03 10:30:00', 0.00),
(1, 22, 'K-022', '2023-12-03 11:00:00', '2023-12-03 11:30:00', 0.21),
(7, 23, 'K-023', '2023-12-01 09:00:00', '2023-12-31 23:59:59', 47.78),
(14, 24, 'K-024', '2023-12-03 23:30:00', '2023-12-04 01:30:00', 1.79),
(1, 26, 'K-025', '2023-12-04 08:00:00', '2023-12-04 08:30:00', 0.27),
(9, 27, 'K-026', '2023-12-01 08:00:00', '2023-12-31 23:59:59', 3.98),
(7, 28, 'K-027', '2023-12-01 07:30:00', '2023-12-31 23:59:59', 47.78),
(1, 29, 'K-028', '2023-12-04 09:00:00', '2023-12-04 09:30:00', 0.32),
(8, 30, 'K-029', '2023-12-01 08:00:00', '2023-12-31 23:59:59', 6.64),
(1, 5, 'K-030', '2023-12-04 10:00:00', '2023-12-04 10:30:00', 0.32);

USE gradski_prijevoz;

-- 13. TABLICA: PREKRŠAJI (Kazne za putnike)
CREATE TABLE prekrsaji (
    id INT AUTO_INCREMENT PRIMARY KEY,
    korisnik_id INT NOT NULL,
    zaposlenik_id INT NOT NULL, -- Kontrolor
    datum_prekrsaja DATETIME DEFAULT CURRENT_TIMESTAMP,
    iznos_kazne DECIMAL(10,2) NOT NULL,
    status_placanja ENUM('Plaćeno', 'Neplaćeno', 'U postupku') DEFAULT 'Neplaćeno',
    napomena TEXT,
    CONSTRAINT fk_prekrsaj_korisnik FOREIGN KEY (korisnik_id) REFERENCES korisnici(id),
    CONSTRAINT fk_prekrsaj_kontrolor FOREIGN KEY (zaposlenik_id) REFERENCES zaposlenik(id),
    CONSTRAINT chk_kazna CHECK (iznos_kazne > 0)
);

INSERT INTO prekrsaji (korisnik_id, zaposlenik_id, datum_prekrsaja, iznos_kazne, status_placanja, napomena) VALUES
(1, 5, '2023-11-01 10:15:00', 50.00, 'Plaćeno', 'Nema kartu'),
(3, 5, '2023-11-02 08:30:00', 50.00, 'Neplaćeno', 'Istekla karta'),
(5, 5, '2023-11-03 14:20:00', 50.00, 'Neplaćeno', 'Pogrešna zona'),
(8, 5, '2023-11-04 17:45:00', 50.00, 'Plaćeno', 'Bez karte'),
(10, 5, '2023-11-05 09:10:00', 50.00, 'U postupku', 'Odbija platiti'),
(12, 5, '2023-11-06 11:30:00', 50.00, 'Neplaćeno', 'Krivotvorena karta'),
(14, 5, '2023-11-07 13:00:00', 50.00, 'Plaćeno', 'Nema dokumente'),
(15, 5, '2023-11-08 15:40:00', 50.00, 'Neplaćeno', 'Istekla studentska'),
(18, 5, '2023-11-09 18:20:00', 50.00, 'Plaćeno', 'Zaboravio pokaz'),
(20, 5, '2023-11-10 07:15:00', 50.00, 'U postupku', 'Nema kartu'),
(21, 5, '2023-11-11 08:50:00', 50.00, 'Neplaćeno', 'Bez karte'),
(23, 5, '2023-11-12 10:05:00', 50.00, 'Plaćeno', 'Istekla 30min'),
(25, 5, '2023-11-13 12:40:00', 50.00, 'Neplaćeno', 'Bez karte'),
(26, 5, '2023-11-14 14:15:00', 50.00, 'Plaćeno', 'Pogrešan smjer'),
(28, 5, '2023-11-15 16:30:00', 50.00, 'Neplaćeno', 'Istekao pokaz'),
(30, 5, '2023-11-16 19:10:00', 50.00, 'Plaćeno', 'Bez karte'),
(1, 5, '2023-11-17 07:30:00', 80.00, 'Neplaćeno', 'Ponovljeni prekršaj'),
(3, 5, '2023-11-18 09:45:00', 50.00, 'Plaćeno', 'Nema kartu'),
(5, 5, '2023-11-19 11:15:00', 50.00, 'U postupku', 'Bez karte'),
(8, 5, '2023-11-20 13:50:00', 50.00, 'Neplaćeno', 'Istekla karta'),
(10, 5, '2023-11-21 15:20:00', 50.00, 'Plaćeno', 'Nema kartu'),
(12, 5, '2023-11-22 17:00:00', 50.00, 'Neplaćeno', 'Bez karte'),
(14, 5, '2023-11-23 08:10:00', 50.00, 'Plaćeno', 'Istekla karta'),
(15, 5, '2023-11-24 10:30:00', 50.00, 'Neplaćeno', 'Bez karte'),
(18, 5, '2023-11-25 12:50:00', 50.00, 'Plaćeno', 'Zaboravljen pokaz'),
(20, 5, '2023-11-26 14:10:00', 50.00, 'U postupku', 'Nema kartu'),
(21, 5, '2023-11-27 16:40:00', 50.00, 'Plaćeno', 'Bez karte'),
(23, 5, '2023-11-28 18:20:00', 50.00, 'Neplaćeno', 'Istekla karta'),
(25, 5, '2023-11-29 20:00:00', 50.00, 'Plaćeno', 'Bez karte'),
(26, 5, '2023-11-30 21:15:00', 50.00, 'Neplaćeno', 'Bez karte');

-- 14. TABLICA: ODRŽAVANJE VOZILA
CREATE TABLE odrzavanje_vozila (
    id INT AUTO_INCREMENT PRIMARY KEY,
    vozilo_id INT NOT NULL,
    zaposlenik_id INT NOT NULL, -- Mehaničar
    datum_servisa DATE NOT NULL,
    vrsta_servisa ENUM('Redovni', 'Izvanredni', 'Tehnički pregled', 'Popravak kvar') NOT NULL,
    trosak_servisa DECIMAL(10,2) NOT NULL,
    opis_radova TEXT,
    FOREIGN KEY (vozilo_id) REFERENCES vozila(id),
    FOREIGN KEY (zaposlenik_id) REFERENCES zaposlenik(id),
    CONSTRAINT chk_trosak CHECK (trosak_servisa >= 0)
);

INSERT INTO odrzavanje_vozila (vozilo_id, zaposlenik_id, datum_servisa, vrsta_servisa, trosak_servisa, opis_radova) VALUES
(1, 8, '2023-01-10', 'Redovni', 1200.00, 'Zamjena ulja i filtera'),
(2, 24, '2023-01-15', 'Tehnički pregled', 300.00, 'Godišnji pregled'),
(3, 8, '2023-02-05', 'Popravak kvar', 450.00, 'Popravak vrata'),
(4, 24, '2023-02-12', 'Redovni', 800.00, 'Kočnice zamjena'),
(5, 8, '2023-03-01', 'Izvanredni', 1500.00, 'Limarija nakon sudara'),
(6, 24, '2023-03-20', 'Redovni', 1100.00, 'Gume zamjena'),
(7, 8, '2023-04-10', 'Popravak kvar', 200.00, 'Zamjena sijalica'),
(8, 24, '2023-04-22', 'Tehnički pregled', 350.00, 'Redovni tehnički'),
(9, 8, '2023-05-05', 'Redovni', 900.00, 'Filteri klime'),
(10, 24, '2023-05-18', 'Izvanredni', 2500.00, 'Generalni remont motora'),
(11, 8, '2023-06-01', 'Redovni', 1300.00, 'Električne instalacije'),
(12, 24, '2023-06-15', 'Popravak kvar', 150.00, 'Brisači'),
(13, 8, '2023-07-02', 'Redovni', 950.00, 'Provjera ovjesa'),
(14, 24, '2023-07-20', 'Tehnički pregled', 300.00, 'Godišnji pregled'),
(15, 8, '2023-08-05', 'Popravak kvar', 600.00, 'Hladnjak zamjena'),
(16, 24, '2023-08-22', 'Redovni', 1200.00, 'Zamjena ulja'),
(17, 8, '2023-09-01', 'Izvanredni', 500.00, 'Staklo bočno zamjena'),
(18, 24, '2023-09-15', 'Redovni', 1400.00, 'Tramvajski kotači tokarenje'),
(19, 8, '2023-10-05', 'Popravak kvar', 850.00, 'Elektronika kabine'),
(20, 24, '2023-10-20', 'Tehnički pregled', 320.00, 'Redovni pregled'),
(21, 8, '2023-11-01', 'Redovni', 900.00, 'Filteri diesel'),
(22, 24, '2023-11-12', 'Izvanredni', 2000.00, 'Kvačilo zamjena'),
(23, 8, '2023-12-01', 'Popravak kvar', 100.00, 'Brava'),
(24, 24, '2023-12-10', 'Redovni', 750.00, 'Akumulator'),
(25, 8, '2023-12-15', 'Redovni', 1100.00, 'Kompresor zraka'),
(26, 24, '2023-12-20', 'Tehnički pregled', 350.00, 'Pregled vozila'),
(27, 8, '2024-01-05', 'Popravak kvar', 1800.00, 'Diferencijal popravak'),
(28, 24, '2024-01-12', 'Redovni', 850.00, 'Svjećice i kablovi'),
(29, 8, '2024-01-20', 'Redovni', 1000.00, 'Ulje mjenjač'),
(30, 24, '2024-01-25', 'Popravak kvar', 400.00, 'Grijanje u busu');

-- 15. TABLICA: KORISNIČKE PRITUŽBE
CREATE TABLE prituzbe (
    id INT AUTO_INCREMENT PRIMARY KEY,
    korisnik_id INT NOT NULL,
    linija_id INT, -- Može biti pritužba na liniju općenito
    datum_prituzbe DATETIME DEFAULT CURRENT_TIMESTAMP,
    kategorija_prituzbe ENUM('Kašnjenje', 'Ponašanje osoblja', 'Čistoća', 'Kvar vozila', 'Ostalo') NOT NULL,
    tekst_prituzbe TEXT NOT NULL,
    status_rjesavanja ENUM('Novo', 'U obradi', 'Riješeno', 'Odbačeno') DEFAULT 'Novo',
    FOREIGN KEY (korisnik_id) REFERENCES korisnici(id),
    FOREIGN KEY (linija_id) REFERENCES linije(id)
);

INSERT INTO prituzbe (korisnik_id, linija_id, kategorija_prituzbe, tekst_prituzbe, status_rjesavanja) VALUES
(1, 1, 'Kašnjenje', 'Tramvaj kasnio 15 minuta', 'Riješeno'),
(3, 6, 'Ponašanje osoblja', 'Vozač bio neugodan', 'Odbačeno'),
(5, 20, 'Čistoća', 'Smeće na sjedalima', 'U obradi'),
(8, 27, 'Kašnjenje', 'Bus nije došao', 'Novo'),
(10, 15, 'Kvar vozila', 'Klima ne radi u busu', 'Riješeno'),
(12, 1, 'Kašnjenje', 'Predugo čekanje na Črnomercu', 'Novo'),
(14, 2, 'Ponašanje osoblja', 'Kontrolor agresivan', 'U obradi'),
(15, 30, 'Ostalo', 'Nema dovoljno mjesta za bicikle', 'Odbačeno'),
(18, 4, 'Kašnjenje', 'Stalna kašnjenja ujutro', 'Riješeno'),
(20, 5, 'Čistoća', 'Graffiti na prozorima', 'Novo'),
(21, 6, 'Kašnjenje', 'Kasni linija 6 stalno', 'Novo'),
(23, 10, 'Kvar vozila', 'Vrata se teško otvaraju', 'U obradi'),
(25, 22, 'Ostalo', 'Loša rasvjeta na stanici', 'Riješeno'),
(26, 27, 'Ponašanje osoblja', 'Pohvala vozaču za ljubaznost', 'Riješeno'),
(28, 28, 'Kašnjenje', 'Kasni bus za V. Goricu', 'Novo'),
(30, 1, 'Čistoća', 'Pod je ljepljiv', 'U obradi'),
(1, 12, 'Kašnjenje', 'Kasni linija 12', 'Novo'),
(3, 11, 'Ponašanje osoblja', 'Vozač puši u vozilu', 'Novo'),
(5, 29, 'Kvar vozila', 'Uspinjača se trese', 'U obradi'),
(8, 20, 'Kašnjenje', 'Zastoj kod Arena centra', 'Riješeno'),
(10, 6, 'Ponašanje osoblja', 'Neprimjeren rječnik', 'Odbačeno'),
(12, 1, 'Čistoća', 'Smrad u tramvaju', 'Novo'),
(14, 2, 'Kašnjenje', 'Kasni 10 minuta', 'Novo'),
(15, 3, 'Kvar vozila', 'Grijanje prejako', 'U obradi'),
(18, 4, 'Kašnjenje', 'Nema busa u 07:00', 'Novo'),
(20, 5, 'Ponašanje osoblja', 'Vozač priča na mobitel', 'U obradi'),
(21, 22, 'Čistoća', 'Prljava stakla', 'Riješeno'),
(23, 23, 'Ostalo', 'Stanica nije natkrita', 'Novo'),
(25, 24, 'Kašnjenje', 'Velike gužve i kašnjenja', 'Novo'),
(26, 25, 'Kvar vozila', 'Škripanje kočnica', 'Novo');